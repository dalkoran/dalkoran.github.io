---
layout: post
title: "ToolBar Buttons"
date: 2008-03-19 13:24
author: spencen
comments: true
categories: [.NET, Development, WPF]
tags: []
---
<P>For the ToolBar/RibbonBar in my hobby application I wanted to continue the trend of using "out-of-the-box" components and simply applying a style to give the correct look.</P>
<P>When placed within a ToolBar control the standard controls (Button, CheckBox, ComboBox etc.) all get a custom style applied giving them a "flat" appearance that suits a ToolBar. Overriding this style turns out to be very easy. Its simply a matter of creating a new style with the correct name. This is explained in the MSDN documentation <A href="http://msdn2.microsoft.com/en-us/library/bb613577.aspx">here</A>.</P>
<P>In practice it looks something like:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabControl</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Style</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">StaticResource</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RibbonBarStyle</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"&gt;<BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">    &lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabControl.Resources</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;<BR>        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Style</SPAN><SPAN style="COLOR: rgb(255,0,0)"> TargetType</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Type</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Key</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Static</SPAN><SPAN style="COLOR: rgb(255,0,0)"> ToolBar</SPAN><SPAN style="COLOR: rgb(0,0,255)">.</SPAN><SPAN style="COLOR: rgb(255,0,0)">ButtonStyleKey</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"&gt;<BR>            ... <BR>        </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Style</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;<BR>    </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabControl.Resources</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;<BR>    ...<BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabControl</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></SPAN></PRE>
<P>A common approach is to use the style to override the Template and remove the default Style (using OverridesDefaultStyle="true"). Going down this path means that your style needs to cater for all button states, e.g. disabled, pressed, focused, mouseover etc.</P>
<P>Currently I've opted for a simpler alternative by using the Style to override only the ContentTemplate that defines the layout of just the content portion of the Button, rather than the entire Template.</P>
<P>So the XAML that I had been using to insert an image button into a ToolBar:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Image</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Source</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/film.png"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Width</SPAN><SPAN style="COLOR: rgb(0,0,255)">="48"/&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TextBlock</SPAN><SPAN style="COLOR: rgb(255,0,0)"> HorizontalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Center"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Video</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">TextBlock</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;<BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> HorizontalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Left"</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Orientation</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Horizontal"&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Image</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Source</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/folder24.png"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Width</SPAN><SPAN style="COLOR: rgb(0,0,255)">="24"/&gt; <BR>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TextBlock</SPAN><SPAN style="COLOR: rgb(255,0,0)"> VerticalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Center"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Open in Windows Explorer</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">TextBlock</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&nbsp;&nbsp;&nbsp; </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></SPAN></PRE>
<P>Becomes:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/film.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Video</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN><SPAN style="COLOR: rgb(0,0,255)"><BR>&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/folder24.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Open in Windows Explorer</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; </SPAN></SPAN></PRE>
<P>For now I'm going to live with the image URI being stuck in the Tag property. Soon I plan on getting rid of the image and text references to be replaced with a single command reference, i.e. binding the command will set the image and text of the button in addition to the button enabled state, visibility etc.</P>
<P>The Style that I'm using is as follows:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Style</SPAN><SPAN style="COLOR: rgb(255,0,0)"> TargetType</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Type</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Key</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Static</SPAN><SPAN style="COLOR: rgb(255,0,0)"> ToolBar</SPAN><SPAN style="COLOR: rgb(0,0,255)">.</SPAN><SPAN style="COLOR: rgb(255,0,0)">ButtonStyleKey</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Margin"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="0"/&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Padding"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="0"/&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="HorizontalAlignment"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Left"/&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="ContentTemplate"&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter.Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTemplate</SPAN><SPAN style="COLOR: rgb(255,0,0)"> DataType</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Type</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">}"&gt; <BR>                </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Border</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Border"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> CornerRadius</SPAN><SPAN style="COLOR: rgb(0,0,255)">="4"&gt; <BR>                    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_panel"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Orientation</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Horizontal"&gt; <BR>                        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Image</SPAN><SPAN style="COLOR: rgb(255,0,0)"> x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_image" <SPAN style="COLOR: rgb(255,0,0)">Margin</SPAN><SPAN style="COLOR: rgb(0,0,255)">="4,0,0,0"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><BR></SPAN><SPAN style="COLOR: rgb(255,0,0)">                                    Width</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RelativeSource</SPAN><SPAN style="COLOR: rgb(0,0,255)">={</SPAN><SPAN style="COLOR: rgb(163,21,21)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(163,21,21)">Static</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RelativeSource</SPAN><SPAN style="COLOR: rgb(0,0,255)">.</SPAN><SPAN style="COLOR: rgb(255,0,0)">Self</SPAN><SPAN style="COLOR: rgb(0,0,255)">},</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                                 Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Source.PixelWidth}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)"><BR>                                    Source</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RelativeSource</SPAN><SPAN style="COLOR: rgb(0,0,255)">=<BR>                                                              {</SPAN><SPAN style="COLOR: rgb(163,21,21)">RelativeSource</SPAN><SPAN style="COLOR: rgb(255,0,0)"> FindAncestor</SPAN><SPAN style="COLOR: rgb(0,0,255)">,</SPAN><SPAN style="COLOR: rgb(255,0,0)"> AncestorType</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Button},</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                                   Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Tag}"/&gt; <BR>                       </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">ContentControl <SPAN style="COLOR: rgb(255,0,0)">x</SPAN><SPAN style="COLOR: rgb(0,0,255)">:</SPAN><SPAN style="COLOR: rgb(255,0,0)">Name</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_text"</SPAN></SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                        Text</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RelativeSource</SPAN><SPAN style="COLOR: rgb(0,0,255)">=<BR>                                                              {</SPAN><SPAN style="COLOR: rgb(163,21,21)">RelativeSource</SPAN><SPAN style="COLOR: rgb(255,0,0)"> FindAncestor</SPAN><SPAN style="COLOR: rgb(0,0,255)">,</SPAN><SPAN style="COLOR: rgb(255,0,0)"> AncestorType</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Button},</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                                    Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Content}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                        VerticalAlignment</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Center"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Margin</SPAN><SPAN style="COLOR: rgb(0,0,255)">="3,0,4,0"/&gt; <BR></SPAN></SPAN><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">                   </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">StackPanel</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>                </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Border</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>                </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTemplate.Triggers</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>                    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN sty
le="COLOR: rgb(163,21,21)">DataTrigger</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Binding</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> ElementName</SPAN><SPAN style="COLOR: rgb(0,0,255)">=PART_image,</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Source.PixelHeight}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                        Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="48"&gt; <BR>                        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> TargetName</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_panel"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Orientation"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Vertical"/&gt; <BR>                    </SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTrigger</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>                    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTrigger</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Binding</SPAN><SPAN style="COLOR: rgb(0,0,255)">="{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> RelativeSource</SPAN><SPAN style="COLOR: rgb(0,0,255)">=<BR>                                                                   {</SPAN><SPAN style="COLOR: rgb(163,21,21)">RelativeSource</SPAN><SPAN style="COLOR: rgb(255,0,0)"> FindAncestor</SPAN><SPAN style="COLOR: rgb(0,0,255)">,</SPAN><SPAN style="COLOR: rgb(255,0,0)"> AncestorType</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Button},</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                                        Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=IsEnabled}"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> <BR>                                    Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="false"&gt; <BR>                        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> TargetName</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_panel"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Opacity"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="0.5"/&gt;<BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">                        &lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(255,0,0)"> TargetName</SPAN><SPAN style="COLOR: rgb(0,0,255)">="PART_text"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Property</SPAN><SPAN style="COLOR: rgb(0,0,255)">="HorizontalAlignment"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Center"/&gt;<BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">                   &lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTrigger</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>                </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTemplate.Triggers</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">DataTemplate</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter.Value</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Setter</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Style</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></SPAN></PRE>
<P>The images themselves are shown using the native resolution. You would have thought Stretch="None" might have done that - but don't be fooled. For reasons relating to DPI scaling you have to set either the Width or Height to an absolute value. I used the Binding <SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">{</SPAN><SPAN style="COLOR: rgb(163,21,21)">Binding</SPAN><SPAN style="COLOR: rgb(255,0,0)"> ElementName</SPAN><SPAN style="COLOR: rgb(0,0,255)">=PART_image,</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Path</SPAN><SPAN style="COLOR: rgb(0,0,255)">=Source.PixelHeight}</SPAN></SPAN> to achieve that.</P>
<P>One trick I did do here is use a Data Trigger to change the placement of the text in relation to the image based on the size of the image that is used. Its a little clunky but I'm using images that are either 16, 24 or 48 pixels sqaure. The 16 and 24 pixel sqaure images have the text positioned to the right of the image. For 48 pixel square images the text is positioned underneath.</P>
<P>So the following XAML:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabItem</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Header</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Hello"&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBarTray</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBar</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Header</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Hello World, I'm a Ribbon Group"&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/note_edit_48.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Write Entry</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/users_family_24.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Maintain Users</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/folder_24.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Open in Windows Explorer</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/weather_48.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Record Weather</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBar</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBar</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Header</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Second Group"&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/film_48.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Video</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/earth_location_24.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Maintain Locations</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/money2_24.png"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> IsEnabled</SPAN><SPAN style="COLOR: rgb(0,0,255)">="False"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Maintain Currencies</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>            </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(255,0,0)"> </SPAN><SPAN style="COLOR: rgb(255,0,0)">Tag</SPAN><SPAN style="COLOR: rgb(0,0,255)">="/Images/presentation_24.png"&gt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">Slideshow</SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">Button</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>        </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBar</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">ToolBarTray</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">TabItem</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></SPAN></PRE>
<P>Generates the following styled TabItem within a parent TabControl.</P>
<P><IMG style="BORDER-TOP-WIDTH: 0px; BORDER-LEFT-WIDTH: 0px; BORDER-BOTTOM-WIDTH: 0px; BORDER-RIGHT-WIDTH: 0px" height=129 alt="XAML Ribbon with Button ContentTemplate Style" src="http://blog.spencen.com/images/83489-72989/XAML%20Ribbon%20with%20Button%20ContentTemplate%20Style_1.png" width=638 border=0> </P>
<P>The buttons lay themselves out nicely arranged automatically from left to right because I've set the ToolBar's ItemsPanel to be a fixed height WrapPanel:</P><PRE class=code><SPAN style="FONT-SIZE: 8pt; FONT-FAMILY: verdana"><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">ItemsPanelTemplate</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt; <BR>    </SPAN><SPAN style="COLOR: rgb(163,21,21)"></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;</SPAN><SPAN style="COLOR: rgb(163,21,21)">WrapPanel</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Orientation</SPAN><SPAN style="COLOR: rgb(0,0,255)">="Vertical"</SPAN><SPAN style="COLOR: rgb(255,0,0)"> Height</SPAN><SPAN style="COLOR: rgb(0,0,255)">="70"/&gt; <BR></SPAN><SPAN style="COLOR: rgb(0,0,255)">&lt;/</SPAN><SPAN style="COLOR: rgb(163,21,21)">ItemsPanelTemplate</SPAN><SPAN style="COLOR: rgb(0,0,255)">&gt;</SPAN></SPAN></PRE>
<P>If you want to customise the button more - for example to give it an orange gradient mouse over effect then you'll need to override the Template rather than ContentTemplate in the Button Style.<BR><BR>[Updated 24-Mar-2008 to use ContentControl instead of TextBlock in the ContentTemplate to allow for Buttons that wanted full control of their own content.]</P>

